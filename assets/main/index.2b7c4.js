window.__require=function e(t,o,n){function i(s,c){if(!o[s]){if(!t[s]){var a=s.split("/");if(a=a[a.length-1],!t[a]){var l="function"==typeof __require&&__require;if(!c&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+s+"'")}s=a}var u=o[s]={exports:{}};t[s][0].call(u.exports,function(e){return i(t[s][1][e]||e)},u,u.exports,e,t,o,n)}return o[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<n.length;s++)i(n[s]);return i}({BoosterManager:[function(e,t,o){"use strict";cc._RF.push(t,"ce34dHk/pxHTaCa02NnG7al","BoosterManager");var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function s(e){try{a(n.next(e))}catch(t){r(t)}}function c(e){try{a(n.throw(e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}a((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return a([e,t])}}function a(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(c){r=[6,c],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterManager=void 0;var r=e("../View/TileView"),s=e("./SpecialTileLogic"),c=e("../Types/Enums"),a=function(){function e(){this.isBombMode=!1,this.isTeleportMode=!1,this.firstSelectedTile=null}return Object.defineProperty(e.prototype,"bombMode",{get:function(){return this.isBombMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"teleportMode",{get:function(){return this.isTeleportMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedTile",{get:function(){return this.firstSelectedTile},enumerable:!1,configurable:!0}),e.prototype.activateBombMode=function(){this.cancelAll(),this.isBombMode=!0},e.prototype.activateTeleportMode=function(){this.cancelAll(),this.isTeleportMode=!0},e.prototype.cancelAll=function(e){var t;if(this.firstSelectedTile&&e){var o=e.getTileNode(this.firstSelectedTile.row,this.firstSelectedTile.col);null===(t=null==o?void 0:o.getComponent(r.default))||void 0===t||t.unhighlight(),e.updateZOrder()}this.isBombMode=!1,this.isTeleportMode=!1,this.firstSelectedTile=null},e.prototype.executeBomb=function(e,t,o,n,i){return i.useBomb(),this.cancelAll(),n.hideGhostBomb(),s.SpecialTileLogic.getRecursiveRange(o.getGrid(),e,t,c.TileType.BOMB)},e.prototype.executeTeleport=function(e,t,o,s){return n(this,void 0,Promise,function(){var n,c,a,l;return i(this,function(i){switch(i.label){case 0:return this.firstSelectedTile?(n=this.firstSelectedTile,c={row:e.row,col:e.col},n.row===c.row&&n.col===c.col?(this.cancelAll(),e.unhighlight(),[2,!1]):(t.swapTiles({r:n.row,c:n.col},{r:c.row,c:c.col}),s.useTeleport(),a=o.getTileNode(n.row,n.col),l=o.getTileNode(c.row,c.col),[4,o.animateSwap(a,l)])):(this.firstSelectedTile={row:e.row,col:e.col},e.highlight(),[2,!1]);case 1:return i.sent(),a.getComponent(r.default).setPos(c.row,c.col),l.getComponent(r.default).setPos(n.row,n.col),this.cancelAll(),o.updateZOrder(),[2,!0]}})})},e}();o.BoosterManager=a,cc._RF.pop()},{"../Types/Enums":"Enums","../View/TileView":"TileView","./SpecialTileLogic":"SpecialTileLogic"}],CollapseLogic:[function(e,t,o){"use strict";cc._RF.push(t,"188a9YZJTVFoYLhqRoTE7fB","CollapseLogic"),Object.defineProperty(o,"__esModule",{value:!0}),o.CollapseLogic=void 0;var n=e("./TileData"),i=function(){function e(){}return e.collapse=function(e,t,o,i){for(var r=[],s=[],c=Array.from({length:t},function(){return Array(o).fill(null)}),a=0;a<o;a++){for(var l=0,u=0;u<t;u++)if(null!==e[u][a]){var p=e[u][a];p.r!==l&&(r.push({fromR:p.r,fromC:a,toR:l,toC:a}),p.r=l),c[l][a]=p,l++}for(u=l;u<t;u++){var h=Math.floor(Math.random()*i);c[u][a]=new n.TileData(u,a,h),s.push({r:u,c:a,type:h})}}return{grid:c,moved:r,created:s}},e}();o.CollapseLogic=i,cc._RF.pop()},{"./TileData":"TileData"}],Constants:[function(e,t,o){"use strict";cc._RF.push(t,"7f613AoSfBJc657Ow5CGnVx","Constants"),Object.defineProperty(o,"__esModule",{value:!0}),o.GAME_CONFIG=void 0,o.GAME_CONFIG={ROWS:10,COLS:9,COLORS_COUNT:5,INITIAL_MOVES:20,TARGET_SCORE:5e3,MIN_MATCH:2,TILE_STEP:100,TILE_WIDTH:100,TILE_HEIGHT:112,BOOSTER_BOMB_COUNT:3,TELEPORT_COUNT:5,SHUFFLE_COUNT:3,TILES_FOR_BOMB:5,TILES_FOR_ROCKET_H:6,TILES_FOR_ROCKET_V:7,TILES_FOR_DYNAMITE:8,SCORE_MULT_STANDART:10,SCORE_MULT_1:35,SCORE_MULT_2:80},cc._RF.pop()},{}],Enums:[function(e,t,o){"use strict";cc._RF.push(t,"6d91aefyJBP3qDdjfQpCVtB","Enums"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameStatus=o.TileType=void 0,function(e){e[e.BLUE=0]="BLUE",e[e.GREEN=1]="GREEN",e[e.YELLOW=2]="YELLOW",e[e.RED=3]="RED",e[e.PURPLE=4]="PURPLE",e[e.BOMB=100]="BOMB",e[e.ROCKET_H=101]="ROCKET_H",e[e.ROCKET_V=102]="ROCKET_V",e[e.DYNAMITE=103]="DYNAMITE"}(o.TileType||(o.TileType={})),function(e){e[e.PLAYING=0]="PLAYING",e[e.WON=1]="WON",e[e.LOST=2]="LOST"}(o.GameStatus||(o.GameStatus={})),cc._RF.pop()},{}],GameController:[function(e,t,o){"use strict";cc._RF.push(t,"45427b7wmdKFqu7St0DbGoP","GameController");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},s=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function s(e){try{a(n.next(e))}catch(t){r(t)}}function c(e){try{a(n.throw(e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}a((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return a([e,t])}}function a(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(c){r=[6,c],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../Core/GridModel"),l=e("../Core/GameState"),u=e("../Core/BoosterManager"),p=e("../View/GridView"),h=e("../View/UIManager"),f=e("../View/TileView"),d=e("../Utils/Constants"),y=e("../Types/Enums"),g=e("../Core/MatchLogic"),v=e("../Core/SpecialTileLogic"),_=e("./SoundController"),T=e("../Utils/Utils"),b=cc._decorator,m=b.ccclass,C=b.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gridView=null,t.uiManager=null,t.isProcessing=!1,t.debug=!0,t}return i(t,e),t.prototype.onLoad=function(){this.model=new a.GridModel(d.GAME_CONFIG.ROWS,d.GAME_CONFIG.COLS),this.model.createGrid(d.GAME_CONFIG.COLORS_COUNT),this.state=new l.GameState(d.GAME_CONFIG.INITIAL_MOVES,d.GAME_CONFIG.BOOSTER_BOMB_COUNT,d.GAME_CONFIG.TELEPORT_COUNT,d.GAME_CONFIG.SHUFFLE_COUNT),this.boosterManager=new u.BoosterManager,this.registerEvents(),this.uiManager.winScreen&&(this.uiManager.winScreen.active=!1),this.uiManager.loseScreen&&(this.uiManager.loseScreen.active=!1)},t.prototype.registerEvents=function(){cc.Canvas.instance.node.on("TILE_CLICK",this.onTileClick,this),cc.Canvas.instance.node.on(cc.Node.EventType.MOUSE_MOVE,this.onMouseMove,this),cc.Canvas.instance.node.on(cc.Node.EventType.TOUCH_MOVE,this.onMouseMove,this),cc.Canvas.instance.node.on(cc.Node.EventType.TOUCH_START,this.onTouchMove,this),cc.Canvas.instance.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)},t.prototype.onDestroy=function(){cc.Canvas.instance.node.off("TILE_CLICK",this.onTileClick,this),cc.Canvas.instance.node.off(cc.Node.EventType.MOUSE_MOVE,this.onMouseMove,this),cc.Canvas.instance.node.off(cc.Node.EventType.TOUCH_MOVE,this.onMouseMove,this)},t.prototype.start=function(){var e=this;this.uiManager&&this.uiManager.startLoadingAnimation(),cc.resources.preloadDir("tiles",cc.SpriteFrame,function(){e.gridView.initView(e.model),e.updateUI(),cc.tween(e.node).delay(1.2).call(function(){e.uiManager.hideLoadingScreen()}).start()})},t.prototype.onMouseMove=function(e){this.boosterManager.bombMode&&this.gridView&&(this.gridView.updateGhostPosition(e.getLocation()),this.gridView.showGhostIfNeeded())},t.prototype.onTouchMove=function(e){this.boosterManager.bombMode&&this.gridView&&(this.gridView.updateGhostPosition(e.getLocation()),this.gridView.showGhostIfNeeded())},t.prototype.onTileClick=function(e){return s(this,void 0,void 0,function(){var t;return c(this,function(o){switch(o.label){case 0:return this.state.status!==y.GameStatus.PLAYING?[2]:this.isProcessing?[2]:(t=e.target.getComponent(f.default))?this.boosterManager.bombMode?[4,this.executeBombBooster(t.row,t.col)]:[3,2]:[2];case 1:return o.sent(),[3,6];case 2:return this.boosterManager.teleportMode?[4,this.handleTeleport(t)]:[3,4];case 3:return o.sent(),[3,6];case 4:return[4,this.handleMatch(t.row,t.col)];case 5:o.sent(),o.label=6;case 6:return[2]}})})},t.prototype.activateBombBooster=function(){if(!this.isProcessing)return this.boosterManager.bombMode?(this.boosterManager.cancelAll(this.gridView),this.gridView.hideGhostBomb(),void this.updateUI()):void(this.state.bombCount<=0?_.default.instance.playError():(_.default.instance.playClick(),this.boosterManager.cancelAll(this.gridView),this.boosterManager.activateBombMode(),this.gridView.showGhostBomb(y.TileType.BOMB)))},t.prototype.activateTeleport=function(){if(!this.isProcessing)return this.boosterManager.teleportMode?(this.boosterManager.cancelAll(this.gridView),void this.updateUI()):void(this.state.teleportCount<=0?_.default.instance.playError():(_.default.instance.playClick(),this.boosterManager.cancelAll(this.gridView),this.gridView.hideGhostBomb(),this.boosterManager.activateTeleportMode()))},t.prototype.executeBombBooster=function(e,t){return s(this,void 0,void 0,function(){var o;return c(this,function(n){switch(n.label){case 0:this.isProcessing=!0,n.label=1;case 1:return n.trys.push([1,,4,5]),o=this.boosterManager.executeBomb(e,t,this.model,this.gridView,this.state),_.default.instance.playBombExplosion(),o.length>0?(this.state.useMove(),[4,this.processRemoval(o,20)]):[3,3];case 2:n.sent(),this.checkGameStatus(),n.label=3;case 3:return[3,5];case 4:return this.isProcessing=!1,this.updateUI(),[7];case 5:return[2]}})})},t.prototype.handleTeleport=function(e){return s(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.boosterManager.executeTeleport(e,this.model,this.gridView,this.state)];case 1:return t.sent()&&(this.state.useMove(),this.updateUI(),_.default.instance.playTeleport(),this.gridView.updateZOrder(),this.checkGameStatus()),[2]}})})},t.prototype.handleMatch=function(e,t){return s(this,void 0,void 0,function(){var o,n,i,r,s,a;return c(this,function(c){switch(c.label){case 0:if(!(o=this.model.getTile(e,t)))return[2];this.isProcessing=!0,c.label=1;case 1:return c.trys.push([1,,11,12]),n=[],i=d.GAME_CONFIG.SCORE_MULT_STANDART,r=!1,v.SpecialTileLogic.isSpecialTile(o.type)?(o.type===y.TileType.DYNAMITE?_.default.instance.playDynamiteExplosion():_.default.instance.playBombExplosion(),n=v.SpecialTileLogic.getRecursiveRange(this.model.getGrid(),e,t,o.type),i=d.GAME_CONFIG.SCORE_MULT_2,o.type!==y.TileType.ROCKET_H&&o.type!==y.TileType.ROCKET_V?[3,3]:(_.default.instance.playRocket(),this.gridView.animateRocket(e,t,o.type),[4,T.Utils.delay(100)])):[3,4];case 2:c.sent(),c.label=3;case 3:return r=!0,[3,8];case 4:return(s=g.MatchLogic.findMatches(this.model.getGrid(),e,t)).length<d.GAME_CONFIG.MIN_MATCH?(this.isProcessing=!1,[2]):null===(a=this.model.upgradeToBonus(e,t,s.length))?[3,6]:(_.default.instance.playBonusCreated(),[4,this.gridView.animateBonusCreation(e,t,a)]);case 5:return c.sent(),n=s.filter(function(o){return!(o.r===e&&o.c===t)}),[3,7];case 6:n=s,c.label=7;case 7:r=!0,c.label=8;case 8:return r&&(this.state.useMove(),this.updateUI()),n.length>0?[4,this.processRemoval(n,i)]:[3,10];case 9:c.sent(),c.label=10;case 10:return this.checkGameStatus(),[3,12];case 11:return this.isProcessing=!1,this.updateUI(),[7];case 12:return[2]}})})},t.prototype.processRemoval=function(e,t){return s(this,void 0,void 0,function(){var o,n,i;return c(this,function(r){switch(r.label){case 0:return o=e.filter(function(e,t,o){return t===o.findIndex(function(t){return t.r===e.r&&t.c===e.c})}),n=t>=d.GAME_CONFIG.SCORE_MULT_1,this.state.addScore(o.length*t),this.model.removeTiles(o),_.default.instance.playPoof(),this.gridView.removeTiles(o,n),[4,T.Utils.delay(150)];case 1:return r.sent(),i=this.model.collapse(),[4,this.gridView.applyCollapse(i)];case 2:return r.sent(),[4,this.checkAndHandleNoMoves()];case 3:return r.sent(),[2]}})})},t.prototype.checkAndHandleNoMoves=function(e){return void 0===e&&(e=0),s(this,void 0,void 0,function(){var t;return c(this,function(o){switch(o.label){case 0:return e>5?[2]:this.state.score>=d.GAME_CONFIG.TARGET_SCORE?(this.checkGameStatus(),[2]):(t=g.MatchLogic.hasPossibleMatches(this.model.getGrid())||this.state.bombCount>0,this.state.moves<=0&&this.state.score<d.GAME_CONFIG.TARGET_SCORE?(this.state.setStatus(y.GameStatus.LOST),this.checkGameStatus(),[2]):t?[3,4]:this.state.shuffleCount>0?(this.isProcessing=!0,this.state.useShuffle(),this.updateUI(),_.default.instance.playTeleport(),this.model.shuffleGrid(),[4,this.gridView.animateTensionShuffle(this.model)]):[3,3]);case 1:return o.sent(),this.isProcessing=!1,[4,this.checkAndHandleNoMoves(e+1)];case 2:return o.sent(),[3,4];case 3:this.state.setStatus(y.GameStatus.LOST),this.checkGameStatus(),o.label=4;case 4:return[2]}})})},t.prototype.checkGameStatus=function(){if(this.state.score>=d.GAME_CONFIG.TARGET_SCORE)return this.state.setStatus(y.GameStatus.WON),_.default.instance.playWin(),this.uiManager.showEndScreen(this.uiManager.winScreen),void this.updateUI();this.state.status===y.GameStatus.LOST&&(_.default.instance.playLose(),this.uiManager.showEndScreen(this.uiManager.loseScreen),this.updateUI())},t.prototype.onRestartClick=function(){_.default.instance.playClick(),this.isProcessing=!0,cc.Canvas.instance.node.off("TILE_CLICK"),this.uiManager.loadingScreen?(this.uiManager.loadingScreen.active=!0,this.uiManager.loadingScreen.opacity=0,this.uiManager.loadingScreen.scale=1,cc.tween(this.uiManager.loadingScreen).to(.4,{opacity:255}).call(function(){_.default.instance.stopAll(),cc.director.loadScene(cc.director.getScene().name)}).start()):cc.director.loadScene(cc.director.getScene().name)},t.prototype.updateUI=function(){this.uiManager&&(this.uiManager.updateScore(this.state.score,d.GAME_CONFIG.TARGET_SCORE),this.uiManager.updateMoves(this.state.moves),this.uiManager.updateBoosterCount("bomb",this.state.bombCount),this.uiManager.updateBoosterCount("teleport",this.state.teleportCount))},r([C(p.default)],t.prototype,"gridView",void 0),r([C(h.default)],t.prototype,"uiManager",void 0),r([m],t)}(cc.Component);o.default=w,cc._RF.pop()},{"../Core/BoosterManager":"BoosterManager","../Core/GameState":"GameState","../Core/GridModel":"GridModel","../Core/MatchLogic":"MatchLogic","../Core/SpecialTileLogic":"SpecialTileLogic","../Types/Enums":"Enums","../Utils/Constants":"Constants","../Utils/Utils":"Utils","../View/GridView":"GridView","../View/TileView":"TileView","../View/UIManager":"UIManager","./SoundController":"SoundController"}],GameState:[function(e,t,o){"use strict";cc._RF.push(t,"4367csbag9PuLx2+luJO+Ti","GameState"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameState=void 0;var n=e("../Types/Enums"),i=function(){function e(e,t,o,i){this._score=0,this._status=n.GameStatus.PLAYING,this._moves=e,this._bombCount=t,this._teleportCount=o,this._shuffleCount=i}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"moves",{get:function(){return this._moves},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bombCount",{get:function(){return this._bombCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"teleportCount",{get:function(){return this._teleportCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shuffleCount",{get:function(){return this._shuffleCount},enumerable:!1,configurable:!0}),e.prototype.addScore=function(e){this._score+=e},e.prototype.useMove=function(){this._moves--},e.prototype.useBomb=function(){this._bombCount--},e.prototype.useTeleport=function(){this._teleportCount--},e.prototype.useShuffle=function(){this._shuffleCount--},e.prototype.setStatus=function(e){this._status=e},e}();o.GameState=i,cc._RF.pop()},{"../Types/Enums":"Enums"}],GlowCircle:[function(e,t,o){"use strict";cc._RF.push(t,"d7746VGmNhNzZC3CKgyrSXB","GlowCircle");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,c=s.ccclass,a=(s.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onLoad=function(){var e=this.getComponent(cc.Graphics);e.clear(),e.fillColor=cc.Color.WHITE,e.circle(0,0,50),e.fill()},r([c],t)}(cc.Component));o.default=a,cc._RF.pop()},{}],GridModel:[function(e,t,o){"use strict";cc._RF.push(t,"2c3088MYENFGKpl7Jt5FMlQ","GridModel");var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<o;t++)for(var r=arguments[t],s=0,c=r.length;s<c;s++,i++)n[i]=r[s];return n};Object.defineProperty(o,"__esModule",{value:!0}),o.GridModel=void 0;var i=e("./TileData"),r=e("../Utils/Constants"),s=e("./CollapseLogic"),c=e("../Utils/Utils"),a=e("./SpecialTileLogic"),l=function(){function e(e,t){this._grid=[],this.rows=e,this.cols=t,this._grid=Array.from({length:e},function(){return Array(t).fill(null)})}return e.prototype.collapse=function(){var e=s.CollapseLogic.collapse(this._grid,this.rows,this.cols,r.GAME_CONFIG.COLORS_COUNT);return this._grid=e.grid,{moved:e.moved,created:e.created}},e.prototype.createGrid=function(e){for(var t=0;t<this.rows;t++){this._grid[t]=[];for(var o=0;o<this.cols;o++){var n=Math.floor(Math.random()*e);this._grid[t][o]=new i.TileData(t,o,n)}}},e.prototype.isValid=function(e,t){return c.Utils.isValid(e,t,this.rows,this.cols)},e.prototype.getTile=function(e,t){return this.isValid(e,t)?this._grid[e][t]:null},e.prototype.getGrid=function(){return this._grid.map(function(e){return n(e)})},e.prototype.removeTiles=function(e){var t=this;e.forEach(function(e){t.isValid(e.r,e.c)&&(t._grid[e.r][e.c],t._grid[e.r][e.c]=null)})},e.prototype.upgradeToBonus=function(e,t,o){var n=a.SpecialTileLogic.getBonusType(o);return null!==n&&this.setTileType(e,t,n),n},e.prototype.setTileType=function(e,t,o){this.isValid(e,t)&&this._grid[e][t]&&(this._grid[e][t].type=o)},e.prototype.swapTiles=function(e,t){if(this.isValid(e.r,e.c)&&this.isValid(t.r,t.c)){var o=this._grid[e.r][e.c],n=this._grid[t.r][t.c];o&&n&&(this._grid[e.r][e.c]=n,this._grid[t.r][t.c]=o,o.r=t.r,o.c=t.c,n.r=e.r,n.c=e.c)}},e.prototype.shuffleGrid=function(){for(var e,t=[],o=[],n=0;n<this.rows;n++)for(var i=0;i<this.cols;i++)(a=this._grid[n][i])&&(t.push(a),o.push({r:n,c:i}));for(var r=t.map(function(e){return{r:e.r,c:e.c}}),s=t.length-1;s>0;s--){var c=Math.floor(Math.random()*(s+1));e=[t[c],t[s]],t[s]=e[0],t[c]=e[1]}for(s=0;s<t.length;s++){var a=t[s],l=o[s];a.r=l.r,a.c=l.c,this._grid[l.r][l.c]=a}return r},e}();o.GridModel=l,cc._RF.pop()},{"../Utils/Constants":"Constants","../Utils/Utils":"Utils","./CollapseLogic":"CollapseLogic","./SpecialTileLogic":"SpecialTileLogic","./TileData":"TileData"}],GridView:[function(e,t,o){"use strict";cc._RF.push(t,"5a489zAdEJMWriUBEbmZJfa","GridView");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},s=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function s(e){try{a(n.next(e))}catch(t){r(t)}}function c(e){try{a(n.throw(e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}a((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return a([e,t])}}function a(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(c){r=[6,c],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<o;t++)for(var r=arguments[t],s=0,c=r.length;s<c;s++,i++)n[i]=r[s];return n};Object.defineProperty(o,"__esModule",{value:!0});var l=e("../Types/Enums"),u=e("../Utils/Constants"),p=e("./TileView"),h=cc._decorator,f=h.ccclass,d=h.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tilePrefab=null,t.explosionPrefab=null,t.rocketPrefab=null,t.tilesNodes=[],t.tilePool=new cc.NodePool("TileView"),t.ghostPool=new cc.NodePool,t.ghostBomb=null,t.TILE_STEP=u.GAME_CONFIG.TILE_STEP,t.TILE_WIDTH=u.GAME_CONFIG.TILE_WIDTH,t.TILE_HEIGHT=u.GAME_CONFIG.TILE_HEIGHT,t}return i(t,e),t.prototype.initView=function(e){var t=this;this.node.children.forEach(function(e){return t.tilePool.put(e)}),this.node.removeAllChildren();for(var o=0;o<e.rows;o++)for(var n=0;n<e.cols;n++){var i=e.getTile(o,n);if(i){var r=this.getTileFromPool();r.parent=this.node;var s=r.getComponent(cc.Sprite);s&&(s.sizeMode=cc.Sprite.SizeMode.RAW,s.trim=!1),r.setContentSize(this.TILE_WIDTH,this.TILE_HEIGHT);var c=(n-(e.cols-1)/2)*this.TILE_STEP,a=(o-(e.rows-1)/2)*this.TILE_STEP;r.setPosition(c,a);var l=r.getComponent("TileView");l&&l.init(i.type,o,n)}}},t.prototype.getTileFromPool=function(){var e=this.tilePool.size()>0?this.tilePool.get():cc.instantiate(this.tilePrefab);return e.opacity=255,e.scale=1,e},t.prototype.animateBonusCreation=function(e,t,o){return s(this,void 0,Promise,function(){var n,i=this;return c(this,function(){return(n=this.getTileNode(e,t))?[2,new Promise(function(r){cc.tween(n).to(.15,{scale:0},{easing:"backIn"}).call(function(){var r=n.getComponent(p.default);if(r&&r.init(o,e,t),i.explosionPrefab){var s=cc.instantiate(i.explosionPrefab);s.parent=i.node,s.setPosition(n.position),s.setScale(.5),cc.tween(s).delay(.3).call(function(){return s.destroy()}).start()}}).to(.25,{scale:1.2},{easing:"expoOut"}).to(.1,{scale:1}).call(function(){return r()}).start()})]:[2]})})},t.prototype.removeTiles=function(e,t){var o=this;void 0===t&&(t=!1);var n=[cc.color(70,150,255),cc.color(0,255,0),cc.color(255,255,0),cc.color(255,0,0),cc.color(255,0,255)];e.forEach(function(e,i){var r=o.getTileNode(e.r,e.c);if(r){var s=r.getComponent(p.default),c=s?s.type:0,a=n[c]||cc.Color.WHITE;if(r.stopAllActions(),o.explosionPrefab){var l=cc.instantiate(o.explosionPrefab);o.node.addChild(l),l.setPosition(r.position),l.zIndex=5e3;var u=l.getChildByName("Glow");u&&(u.color=a,u.active=!!t&&0===i);var h=l.getChildByName("Sparks");if(h){var f=h.getComponent(cc.ParticleSystem);f&&(f.startColor=a,f.endColor=a,f.startColorVar=cc.color(0,0,0,0),f.endColorVar=cc.color(0,0,0,0),f.resetSystem())}l.getComponentsInChildren(cc.ParticleSystem).forEach(function(e){"Sparks"!==e.node.name&&e.resetSystem()}),l.setScale(t&&0===i?3:1),cc.tween(l).delay(.5).call(function(){return l.destroy()}).start()}cc.tween(r).to(.1,{scale:0,opacity:0}).call(function(){o.tilePool.put(r)}).start()}}),t&&cc.tween(this.node).by(.05,{x:10,y:5}).by(.05,{x:-20,y:-10}).by(.05,{x:10,y:5}).to(.05,{x:0,y:0}).start()},t.prototype.animateRocket=function(e,t,o){var n=this.getTileNode(e,t);if(n&&this.rocketPrefab){n.opacity=0;var i=cc.instantiate(this.rocketPrefab);this.node.addChild(i);var r=n.getPosition();i.setPosition(r),i.zIndex=9999;var s=i.getChildByName("Part1"),c=i.getChildByName("Part2"),a=u.GAME_CONFIG.TILE_STEP,p=u.GAME_CONFIG.COLS*u.GAME_CONFIG.TILE_STEP/2-a,h=u.GAME_CONFIG.ROWS*u.GAME_CONFIG.TILE_STEP/2-a;if(o===l.TileType.ROCKET_H){s.scaleX=1,c.scaleX=-1;var f=p-r.x,d=-p-r.x;cc.tween(s).to(.25,{x:f},{easing:"quadIn"}).call(function(){return s.active=!1}).start(),cc.tween(c).to(.25,{x:d},{easing:"quadIn"}).call(function(){return c.active=!1}).start()}else{s.angle=90,c.angle=-90;var y=h-r.y,g=-h-r.y;cc.tween(s).to(.25,{y:y},{easing:"quadIn"}).call(function(){return s.active=!1}).start(),cc.tween(c).to(.25,{y:g},{easing:"quadIn"}).call(function(){return c.active=!1}).start()}cc.tween(i).delay(.3).call(function(){return i.destroy()}).start()}},t.prototype.onDestroy=function(){this.tilePool&&this.tilePool.clear(),this.ghostPool&&this.ghostPool.clear()},t.prototype.applyCollapse=function(e){return s(this,void 0,Promise,function(){var t,o=this;return c(this,function(n){switch(n.label){case 0:return t=[],this.schedule(this.updateZOrder,.05),e.moved.forEach(function(e){var n=o.getTileNode(e.fromR,e.fromC);if(n){n.stopAllActions();var i=n.getComponent("TileView");i.row=e.toR,i.col=e.toC;var r=(e.toR-(u.GAME_CONFIG.ROWS-1)/2)*o.TILE_STEP,s=new Promise(function(e){cc.tween(n).to(.35,{y:r},{easing:"circOut"}).call(function(){return e()}).start()});t.push(s)}}),e.created.forEach(function(e){var n=o.getTileFromPool();n.parent=o.node,n.opacity=0,n.scale=1,n.active=!0;var i=(e.c-(u.GAME_CONFIG.COLS-1)/2)*o.TILE_STEP,r=(e.r-(u.GAME_CONFIG.ROWS-1)/2)*o.TILE_STEP,s=(u.GAME_CONFIG.ROWS-1)/2*o.TILE_STEP+o.TILE_STEP+.5*(u.GAME_CONFIG.ROWS-e.r)*o.TILE_STEP;n.setPosition(i,s);var c=n.getComponent(p.default);c&&c.init(e.type,e.r,e.c);var a=new Promise(function(t){cc.tween(n).delay(.02*(u.GAME_CONFIG.ROWS-e.r)).parallel(cc.tween().to(.3,{y:r},{easing:"circOut"}),cc.tween().delay(.05).to(.1,{opacity:255})).call(function(){return t()}).start()});t.push(a)}),[4,Promise.all(t)];case 1:return n.sent(),this.unschedule(this.updateZOrder),this.updateZOrder(),this.rebuildNodesArray(),[2]}})})},t.prototype.rebuildNodesArray=function(){var e=this;this.tilesNodes=Array.from({length:u.GAME_CONFIG.ROWS},function(){return new Array(u.GAME_CONFIG.COLS).fill(null)}),this.node.children.forEach(function(t){var o=t.getComponent(p.default);o&&cc.isValid(t)&&e.tilesNodes[o.row]&&(e.tilesNodes[o.row][o.col]=t)})},t.prototype.showGhostIfNeeded=function(){this.ghostBomb&&(this.ghostBomb.active&&this.ghostBomb.getNumberOfRunningActions()>0||(this.ghostBomb.active=!0,this.ghostBomb.opacity=255,cc.tween(this.ghostBomb).to(.5,{opacity:100}).to(.5,{opacity:255}).union().repeatForever().start()))},t.prototype.showGhostBomb=function(e){var t=this;this.ghostBomb&&this.hideGhostBomb(),this.ghostBomb=this.ghostPool.size()>0?this.ghostPool.get():new cc.Node("GhostBomb"),this.ghostBomb.parent=cc.Canvas.instance.node,this.ghostBomb.zIndex=1e4,this.ghostBomb.opacity=0,this.ghostBomb.scale=1;var o=this.ghostBomb.getComponent(cc.Sprite);o||(o=this.ghostBomb.addComponent(cc.Sprite)),cc.resources.load("tiles/tile_"+e,cc.SpriteFrame,function(e,n){!e&&o&&cc.isValid(t.ghostBomb)&&(o.spriteFrame=n,o.sizeMode=cc.Sprite.SizeMode.CUSTOM,t.ghostBomb.setContentSize(t.TILE_WIDTH,t.TILE_HEIGHT))})},t.prototype.hideGhostBomb=function(){this.ghostBomb&&(this.ghostBomb.stopAllActions(),this.ghostPool.put(this.ghostBomb),this.ghostBomb=null)},t.prototype.updateGhostPosition=function(e){if(this.ghostBomb){this.ghostBomb.active&&0!==this.ghostBomb.opacity||this.showGhostIfNeeded();var t=this.ghostBomb.parent.convertToNodeSpaceAR(e);this.ghostBomb.setPosition(t)}},t.prototype.updateZOrder=function(){if(this.node&&cc.isValid(this.node)){var e=this.node.children.filter(function(e){return cc.isValid(e)});e.sort(function(e,t){return e.y-t.y}),e.forEach(function(e,t){e.zIndex<9e3&&(e.zIndex=t)})}},t.prototype.animateSwap=function(e,t){return s(this,void 0,Promise,function(){var o,n,i,r,s=this;return c(this,function(){return o=e.getPosition(),n=t.getPosition(),i=e.getComponent(p.default),r=t.getComponent(p.default),i&&r?[2,new Promise(function(c){e.stopAllActions(),t.stopAllActions(),e.scale=1,t.scale=1,e.zIndex=1e3,t.zIndex=1001;var a=0,l=setInterval(function(){s.updateZOrder()},50);cc.tween(e).to(.3,{position:cc.v3(n.x,n.y,0)},{easing:"quartInOut",onUpdate:function(t){t>=.33&&1e3===e.zIndex&&(e.zIndex=r.row)}}).call(function(){2==++a&&(clearInterval(l),s.updateZOrder(),c())}).start(),cc.tween(t).to(.3,{position:cc.v3(o.x,o.y,0)},{easing:"quartInOut",onUpdate:function(e){e>=.33&&1001===t.zIndex&&(t.zIndex=i.row)}}).call(function(){2==++a&&(s.updateZOrder(),c())}).start()})]:[2,Promise.resolve()]})})},t.prototype.getTileNode=function(e,t){return this.node.children.find(function(o){var n=o.getComponent("TileView");return n&&n.row===e&&n.col===t})},t.prototype.animateTensionShuffle=function(e){return s(this,void 0,void 0,function(){var t,o=this;return c(this,function(n){switch(n.label){case 0:return t=[],a(this.node.children).forEach(function(n){var i=n.getComponent("TileView");if(i){var r=n.getPosition(),s=(i.col-(e.cols-1)/2)*o.TILE_STEP,c=(i.row-(e.rows-1)/2)*o.TILE_STEP,a=cc.v2(s,c),l=a.sub(r).normalize(),u=r.sub(l.mul(30)),p=new Promise(function(t){cc.tween(n).to(.1,{position:cc.v3(u.x,u.y),scale:1.1},{easing:"quadOut"}).to(.3,{position:cc.v3(r.x,r.y),scale:0},{easing:"fade"}).call(function(){var t=e.getTile(i.row,i.col);t&&i.init(t.type,i.row,i.col),n.setPosition(a.x,a.y),n._updateWorldMatrix()}).to(.4,{scale:1,opacity:255},{easing:"expoIn"}).call(function(){t()}).start()});t.push(p)}}),[4,Promise.all(t)];case 1:return n.sent(),this.node.active=!0,[2]}})})},t.prototype.updateTileView=function(e,t,o){var n=this.getTileNode(e,t);if(n){var i=n.getComponent(p.default);i&&i.init(o,e,t)}else cc.warn("Node not found at "+e+","+t+" for updateTileView")},r([d(cc.Prefab)],t.prototype,"tilePrefab",void 0),r([d(cc.Prefab)],t.prototype,"explosionPrefab",void 0),r([d(cc.Prefab)],t.prototype,"rocketPrefab",void 0),r([f],t)}(cc.Component);o.default=y,cc._RF.pop()},{"../Types/Enums":"Enums","../Utils/Constants":"Constants","./TileView":"TileView"}],Interfaces:[function(e,t,o){"use strict";cc._RF.push(t,"11392KPOdlMh5/QNlJfMpsN","Interfaces"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],MatchLogic:[function(e,t,o){"use strict";cc._RF.push(t,"46b1fI8JnVEYLsJpymbutsc","MatchLogic"),Object.defineProperty(o,"__esModule",{value:!0}),o.MatchLogic=void 0;var n=e("../Utils/Utils"),i=e("./SpecialTileLogic"),r=function(){function e(){}return e.findMatches=function(e,t,o){var r,s,c=null===(r=e[t][o])||void 0===r?void 0:r.type;if(null==c||i.SpecialTileLogic.isSpecialTile(c))return[];var a=e.length,l=e[0].length,u=[],p=Array.from({length:a},function(){return Array(l).fill(!1)}),h=[{r:t,c:o}];for(p[t][o]=!0;h.length>0;){var f=h.shift();u.push(f);for(var d=0,y=[[0,1],[0,-1],[1,0],[-1,0]];d<y.length;d++){var g=y[d],v=g[0],_=g[1],T=f.r+v,b=f.c+_;n.Utils.isValid(T,b,a,l)&&!p[T][b]&&(null===(s=e[T][b])||void 0===s?void 0:s.type)===c&&(p[T][b]=!0,h.push({r:T,c:b}))}}return u},e.hasPossibleMatches=function(e){for(var t=e.length,o=e[0]?e[0].length:0,n=0;n<t;n++)for(var r=0;r<o;r++){var s=e[n][r];if(s&&null!==s.type){if(i.SpecialTileLogic.isSpecialTile(s.type))return!0;var c=e[n][r+1],a=e[n+1]?e[n+1][r]:null;if(c&&c.type===s.type)return!0;if(a&&a.type===s.type)return!0}}return!1},e}();o.MatchLogic=r,cc._RF.pop()},{"../Utils/Utils":"Utils","./SpecialTileLogic":"SpecialTileLogic"}],SoundController:[function(e,t,o){"use strict";cc._RF.push(t,"46beeFmYkhAfah6Wll0C64m","SoundController");var n=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator.ccclass,r=function(){function e(){this._globalSfxVolume=1,this._activeLoops=new Map,this._cache=new Map}var t;return t=e,Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),e.prototype.playSfxByName=function(e,t,o){var n=this;void 0===t&&(t=!1),void 0===o&&(o=1);var i="sounds/"+e;this._cache.has(e)?this.executePlay(e,this._cache.get(e),t,o):cc.resources.load(i,cc.AudioClip,function(i,r){i?cc.error("Sound not found:",e):(n._cache.set(e,r),n.executePlay(e,r,t,o))})},e.prototype.executePlay=function(e,t,o,n){var i=cc.audioEngine.playEffect(t,o);cc.audioEngine.setVolume(i,this._globalSfxVolume*n),o&&(this.stopSfxByName(e),this._activeLoops.set(e,i))},e.prototype.stopSfxByName=function(e){if(this._activeLoops.has(e)){var t=this._activeLoops.get(e);cc.audioEngine.stopEffect(t),this._activeLoops.delete(e)}},e.prototype.stopAll=function(){cc.audioEngine.stopAllEffects(),this._activeLoops.clear()},e.prototype.setGlobalVolume=function(e){this._globalSfxVolume=e,cc.audioEngine.setEffectsVolume(e)},e.prototype.playClick=function(){this.playSfxByName("pop",!1,.5)},e.prototype.playError=function(){this.playSfxByName("negativeBtn",!1,1)},e.prototype.playBombExplosion=function(){this.playSfxByName("explosion",!1,.3)},e.prototype.playDynamiteExplosion=function(){this.playSfxByName("explosion",!1,.5)},e.prototype.playTeleport=function(){this.playSfxByName("wooshTeleport",!1,.5)},e.prototype.playRocket=function(){this.playSfxByName("rocket",!1,1)},e.prototype.playBonusCreated=function(){this.playSfxByName("bonus",!1,1)},e.prototype.playPoof=function(){this.playSfxByName("poof",!1,1)},e.prototype.playWin=function(){this.playSfxByName("winHorn",!1,1)},e.prototype.playLose=function(){this.playSfxByName("loseHorn",!1,1),this.playRainLoop()},e.prototype.playRainLoop=function(){this.playSfxByName("rain",!0,.8)},e._instance=null,t=n([i],e)}();o.default=r,cc._RF.pop()},{}],SpecialTileLogic:[function(e,t,o){"use strict";cc._RF.push(t,"286faTZ6TJPJIT/kEK4kXcr","SpecialTileLogic"),Object.defineProperty(o,"__esModule",{value:!0}),o.SpecialTileLogic=void 0;var n=e("../Types/Enums"),i=e("../Utils/Utils"),r=e("../Utils/Constants"),s=function(){function e(){}return e.getRange=function(e,t,o,r,s){var c=[];switch(o){case n.TileType.ROCKET_H:for(var a=0;a<s;a++)c.push({r:e,c:a});break;case n.TileType.ROCKET_V:for(a=0;a<r;a++)c.push({r:a,c:t});break;case n.TileType.BOMB:for(a=e-1;a<=e+1;a++)for(var l=t-1;l<=t+1;l++)i.Utils.isValid(a,l,r,s)&&c.push({r:a,c:l});break;case n.TileType.DYNAMITE:for(a=e-2;a<=e+2;a++)for(l=t-2;l<=t+2;l++)i.Utils.isValid(a,l,r,s)&&c.push({r:a,c:l})}return c},e.getRecursiveRange=function(t,o,n,i){var r;if(0===t.length)return[];for(var s=t.length,c=t[0].length,a=[{r:o,c:n}],l=new Set,u=[{r:o,c:n,type:i}];u.length>0;){var p=u.shift(),h=p.r+","+p.c;if(!l.has(h)){l.add(h);for(var f=0,d=this.getRange(p.r,p.c,p.type,s,c);f<d.length;f++){var y=d[f],g=y.r+","+y.c;if(!l.has(g)){a.push(y);var v=null===(r=t[y.r])||void 0===r?void 0:r[y.c];v&&e.isSpecialTile(v.type)&&!l.has(g)&&u.push({r:y.r,c:y.c,type:v.type})}}}}return a},e.getBonusType=function(e){return e>=r.GAME_CONFIG.TILES_FOR_DYNAMITE?n.TileType.DYNAMITE:e===r.GAME_CONFIG.TILES_FOR_ROCKET_V?n.TileType.ROCKET_V:e===r.GAME_CONFIG.TILES_FOR_ROCKET_H?n.TileType.ROCKET_H:e===r.GAME_CONFIG.TILES_FOR_BOMB?n.TileType.BOMB:null},e.isSpecialTile=function(e){return e>=100},e}();o.SpecialTileLogic=s,cc._RF.pop()},{"../Types/Enums":"Enums","../Utils/Constants":"Constants","../Utils/Utils":"Utils"}],TileData:[function(e,t,o){"use strict";cc._RF.push(t,"3c65faJzFxDzK8SQGYCNMR7","TileData"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileData=void 0;o.TileData=function(e,t,o){this.r=e,this.c=t,this.type=o},cc._RF.pop()},{}],TileView:[function(e,t,o){"use strict";cc._RF.push(t,"5229az5OwFGOqaLcHDVc40S","TileView");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../Utils/Constants"),c=cc._decorator,a=c.ccclass,l=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.row=0,t.col=0,t.type=0,t}return i(t,e),t.prototype.unuse=function(){this.node.stopAllActions(),this.node.scale=1,this.node.opacity=255},t.prototype.init=function(e,t,o){var n=this;this.type=e,this.row=t,this.col=o;var i=this.getComponent(cc.Sprite);if(i){this.node.width=s.GAME_CONFIG.TILE_WIDTH,this.node.height=s.GAME_CONFIG.TILE_HEIGHT,this.node.scale=1,i.sizeMode=cc.Sprite.SizeMode.CUSTOM,i.trim=!1;var r="tiles/tile_"+e;cc.resources.load(r,cc.SpriteFrame,function(e,t){if(!e&&cc.isValid(n.node)){var o=n.getComponent(cc.Sprite);o&&(o.spriteFrame=t,n.node.width=s.GAME_CONFIG.TILE_WIDTH,n.node.height=s.GAME_CONFIG.TILE_HEIGHT)}}),this.node.off(cc.Node.EventType.TOUCH_END),this.node.on(cc.Node.EventType.TOUCH_END,function(){n.node.dispatchEvent(new cc.Event.EventCustom("TILE_CLICK",!0))},this)}},t.prototype.highlight=function(){this.node.stopAllActions(),this.node.setSiblingIndex(this.node.parent.childrenCount-1),this.node.zIndex=9999,cc.tween(this.node).to(.2,{scale:1.2}).to(.2,{scale:1.1}).union().repeatForever().start()},t.prototype.unhighlight=function(){var e=this;this.node.stopAllActions(),this.node.zIndex=0,cc.tween(this.node).to(.1,{scale:1}).call(function(){var t=e.node.parent.getComponent("GridView");t&&t.updateZOrder()}).start()},t.prototype.setPos=function(e,t){this.row=e,this.col=t},r([a],t)}(cc.Component));o.default=l,cc._RF.pop()},{"../Utils/Constants":"Constants"}],UIManager:[function(e,t,o){"use strict";cc._RF.push(t,"b2f99YgtwZIG6Rrp2PpVwyi","UIManager");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,c=s.ccclass,a=s.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scoreLabel=null,t.movesLabel=null,t.bombCountLabel=null,t.teleportCountLabel=null,t.loadingScreen=null,t.winScreen=null,t.loseScreen=null,t.bombPatternContainer=null,t}return i(t,e),t.prototype.updateScore=function(e,t){this.scoreLabel&&(this.scoreLabel.string=e+"/"+t)},t.prototype.updateMoves=function(e){this.movesLabel?this.movesLabel.string=""+e:cc.error("MovesLabel \u043d\u0435 \u043f\u0440\u0438\u0432\u044f\u0437\u0430\u043d \u0432 UIManager!")},t.prototype.updateBoosterCount=function(e,t){"bomb"===e&&this.bombCountLabel?this.bombCountLabel.string=t.toString():"teleport"===e&&this.teleportCountLabel&&(this.teleportCountLabel.string=t.toString())},t.prototype.showEndScreen=function(e){var t=this;e&&(e.active=!0,e.scale=.5,e.opacity=0,cc.tween(e).parallel(cc.tween().to(.5,{scale:1},{easing:"backOut"}),cc.tween().to(.3,{opacity:255})).call(function(){e===t.winScreen?t.animateWinElements():e===t.loseScreen&&t.animateLoseElements()}).start())},t.prototype.animateWinElements=function(){var e=this.winScreen.getChildByName("PrizeImg"),t=this.winScreen.getChildByName("Glow");e&&cc.tween(e).repeatForever(cc.tween().by(1.5,{y:20},{easing:"sineInOut"}).by(1.5,{y:-20},{easing:"sineInOut"})).start(),t&&(cc.tween(t).repeatForever(cc.tween().by(5,{angle:360})).start(),cc.tween(t).repeatForever(cc.tween().to(2,{scale:1.2,opacity:180},{easing:"sineInOut"}).to(2,{scale:.9,opacity:100},{easing:"sineInOut"})).start())},t.prototype.animateLoseElements=function(){var e=this.loseScreen.getChildByName("LoseImg");e&&cc.tween(e).repeatForever(cc.tween().by(1.5,{y:20},{easing:"sineInOut"}).by(1.5,{y:-20},{easing:"sineInOut"})).start()},t.prototype.startLoadingAnimation=function(){var e;if(this.bombPatternContainer){this.bombPatternContainer.stopAllActions(),this.bombPatternContainer.y=0,cc.tween(this.bombPatternContainer).repeatForever(cc.tween().to(4,{y:-560},{easing:"linear"}).set({y:0})).start();var t=null===(e=this.loadingScreen)||void 0===e?void 0:e.getChildByName("LoadingLabel");t&&cc.tween(t).to(.8,{scale:1.1},{easing:"sineInOut"}).to(.8,{scale:1},{easing:"sineInOut"}).union().repeatForever().start()}},t.prototype.hideLoadingScreen=function(){var e=this;this.loadingScreen?cc.tween(this.loadingScreen).delay(.2).to(.4,{opacity:0,scale:1.2},{easing:"fade"}).call(function(){e.loadingScreen.active=!1,e.loadingScreen.stopAllActions(),e.bombPatternContainer&&e.bombPatternContainer.stopAllActions()}).start():cc.warn("LoadingScreen \u043d\u0435 \u043f\u0440\u0438\u0432\u044f\u0437\u0430\u043d")},r([a(cc.Label)],t.prototype,"scoreLabel",void 0),r([a(cc.Label)],t.prototype,"movesLabel",void 0),r([a(cc.Label)],t.prototype,"bombCountLabel",void 0),r([a(cc.Label)],t.prototype,"teleportCountLabel",void 0),r([a(cc.Node)],t.prototype,"loadingScreen",void 0),r([a(cc.Node)],t.prototype,"winScreen",void 0),r([a(cc.Node)],t.prototype,"loseScreen",void 0),r([a(cc.Node)],t.prototype,"bombPatternContainer",void 0),r([c],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],Utils:[function(e,t,o){"use strict";cc._RF.push(t,"d6ea866MJpGTo9eWSI/I6qf","Utils"),Object.defineProperty(o,"__esModule",{value:!0}),o.Utils=void 0;var n=function(){function e(){}return e.isValid=function(e,t,o,n){return e>=0&&e<o&&t>=0&&t<n},e.delay=function(e){return new Promise(function(t){return setTimeout(t,e)})},e}();o.Utils=n,cc._RF.pop()},{}]},{},["GameController","SoundController","BoosterManager","CollapseLogic","GameState","GridModel","MatchLogic","SpecialTileLogic","TileData","Enums","Interfaces","Constants","Utils","GlowCircle","GridView","TileView","UIManager"]);